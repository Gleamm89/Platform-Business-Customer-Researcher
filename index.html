<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VAT Capture Finder</title>
  <style>
    body { font-family: system-ui, Arial; max-width: 840px; margin: 40px auto; padding: 0 16px; }
    .card { border: 1px solid #ddd; border-radius: 12px; padding: 16px; margin-top: 16px; }
    input { width: 100%; padding: 12px; font-size: 16px; }
    button { padding: 12px 16px; font-size: 16px; margin-top: 12px; cursor: pointer; }
    .yes { font-weight: 700; }
    .evidence { margin-top: 12px; }
    img { max-width: 100%; border-radius: 10px; border: 1px solid #eee; }
    .muted { color: #666; }
  </style>
</head>
<body>
  <h1>VAT Capture Finder</h1>
  <p class="muted">Paste a developer/API documentation URL. You’ll get a Yes/No plus evidence links (and optionally screenshots).</p>

  <label for="url"><strong>Developer API URL</strong></label>
  <input id="url" placeholder="https://developer.example.com" />
  <button id="run">Check</button>

  <div id="out" class="card" style="display:none;"></div>

<script>
const API_BASE = "https://YOUR_BACKEND_DOMAIN"; // e.g. https://vat-checker.yourcompany.com

const out = document.getElementById("out");
document.getElementById("run").addEventListener("click", async () => {
  const url = document.getElementById("url").value.trim();
  if (!url) return alert("Please enter a URL.");

  out.style.display = "block";
  out.innerHTML = "Running…";

  try {
    const res = await fetch(`${API_BASE}/api/vat-check`, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({ url })
    });
    if (!res.ok) throw new Error(`HTTP ${res.status}`);
    const data = await res.json();

    const yesNo = data.found ? "YES" : "NO";
    let html = `<h2>Result: <span class="yes">${yesNo}</span></h2>`;
    html += `<p class="muted">Checked pages: ${data.checked_pages ?? "—"} · Confidence: ${data.confidence ?? "—"}</p>`;

    if (Array.isArray(data.matched_terms) && data.matched_terms.length) {
      html += `<p><strong>Matched terms:</strong> ${data.matched_terms.join(", ")}</p>`;
    }

    html += `<div class="evidence"><strong>Evidence</strong><ul>`;
    (data.evidence || []).forEach(ev => {
      if (ev.type === "url") {
        html += `<li><a href="${ev.url}" target="_blank" rel="noopener">${ev.url}</a><br><span class="muted">${ev.snippet || ""}</span></li>`;
      }
    });
    html += `</ul></div>`;

    (data.evidence || []).forEach(ev => {
      if (ev.type === "screenshot") {
        html += `<div style="margin-top:12px;"><a href="${ev.url}" target="_blank" rel="noopener">Screenshot</a><br><img src="${ev.url}" alt="screenshot"/></div>`;
      }
    });

    out.innerHTML = html;
  } catch (e) {
    out.innerHTML = `<strong>Error:</strong> ${String(e.message || e)}`;
  }
});
</script>
</body>
</html>
